%LTeX: enabled=false
\documentclass[11pt,a4paper]{report}
\usepackage[a4paper, margin=3cm]{geometry}
\usepackage{array}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage[automake, acronym]{glossaries}
\usepackage{xcolor}
\usepackage[export]{adjustbox}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{float} 
\usepackage{enumitem}
\usepackage{subcaption}
\usepackage{makecell}

\hfuzz=5.6pt 

\usepackage{color}

\definecolor{pblue}{rgb}{0.13,0.13,1}
\definecolor{pgreen}{rgb}{0,0.5,0}
\definecolor{pred}{rgb}{0.9,0,0}
\definecolor{pgrey}{rgb}{0.46,0.45,0.48}
\definecolor{porange}{rgb}{1,0.5,0.1} 

\usepackage{listings}
\lstset{language=Java,
  showspaces=false,
  showtabs=false,
  breaklines=true,
  showstringspaces=false,
  breakatwhitespace=true,
  columns=flexible,
  commentstyle=\color{pgrey},
  keywordstyle=\color{porange},
  stringstyle=\color{pgreen},
  basicstyle={\ttfamily\small},
  moredelim=[il][\textcolor{pgrey}]{\$\$},
  moredelim=[is][\textcolor{pgrey}]{\%\%}{\%\%},
  morekeywords={var, record, yield, sealed, non-sealed, permits}
}

\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  keywordstyle=\color{porange},
  ndkeywords={class, export, default, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{porange}\bfseries,
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{pgrey},
  stringstyle=\color{pgreen},
  morestring=[b]',
  morestring=[b]",
  morestring=[b]`
}

\usepackage{caption}
\captionsetup{font=small}
\captionsetup[sub]{font=scriptsize}

\DeclareCaptionFormat{listing}{
  \rule{\linewidth}{0.2pt}\par\vskip1pt #1#2#3
}
\captionsetup[lstlisting]{format=listing, justification=centering, singlelinecheck=false}

\usepackage[
  backend=biber,
  style=ieee, % or authoryear, numeric, ieee, apa, ...
]{biblatex}
\DefineBibliographyStrings{english}{
  and = {\&}
}

\usepackage{setspace}
\usepackage{etoolbox}
% 1.5 Zeilenabstand
\onehalfspacing
% außer für Listings 
\BeforeBeginEnvironment{lstlisting}{\begin{singlespace}}
\AfterEndEnvironment{lstlisting}{\end{singlespace}}

\usepackage{hyperref} % must be loaded last! 

% Adapted from Source - https://tex.stackexchange.com/a
% Posted by Don Hosek
% Retrieved 2026-01-08, License - CC BY-SA 4.0
\ExplSyntaxOn
\NewDocumentCommand{\javaname}{ m }
  {
    \group_begin:
    \tl_set:Nn \l_tmpa_tl { #1 }
    % Replace dots with dot + allowbreak
    \tl_replace_all:Nnn \l_tmpa_tl { . } { .\allowbreak }
    % Replace dashes with dash + allowbreak
    \tl_replace_all:Nnn \l_tmpa_tl { - } { -\allowbreak }
    
    \texttt{ \tl_use:N \l_tmpa_tl }
    \group_end:
  }
\ExplSyntaxOff


% adapted from https://tex.stackexchange.com/a/720461
% Posted by David Carlisle
% Retrieved 2026-01-23, License - CC BY-SA 4.0
\ExplSyntaxOn
% Create a boolean to track the first character
\bool_new:N \l__cschulz_first_char_bool
\NewDocumentCommand{\keyw}{m}
 {
  \texttt{ \cschulz_keyw:n { #1 } }
 }
\cs_new_protected:Nn \cschulz_keyw:n
 {
  % Initialize the flag to true for every new call
  \bool_set_true:N \l__cschulz_first_char_bool
  \tl_map_inline:nn { #1 }
   {
    % Check if uppercase
    \str_if_eq:eeT { ##1 } { \str_uppercase:n { ##1 } } 
     { 
      % ONLY add the hyphen if it's NOT the first character
      \bool_if:NF \l__cschulz_first_char_bool { \- }
     }
    % Print the character
    ##1
    % After the first character is printed, set flag to false
    \bool_set_false:N \l__cschulz_first_char_bool
   }
 }

\ExplSyntaxOff

\addbibresource{references.bib}

\makeglossaries

%LTeX: enabled=true
\newglossaryentry{api}
{
    name=API, 
    description={API stands for \emph{Application Programming Interface}. It describes the public interface of a module or service, often exposed over a network}
}

\newglossaryentry{rest}
{
    name=REST,
    description={stands for \emph{Representational State Transfer}. It is an architectural style for distributed hypermedia systems}
}

\newglossaryentry{http}
{
    name=HTTP,
    description={stands for \emph{Hypertext Transfer Protocol}. It is a protocol used in internet communication and was defined in RFC 2616 \cite{rfc2616}}
}

\newglossaryentry{adm}
{
    name={Anemic Domain Model},
    description={The objects describing the domain only hold data, no logic}
}

\newglossaryentry{rdm}
{
    name={Rich Domain Model},
    description={Objects incorporate both data and the behavior or rules that govern that data}
}

\newglossaryentry{atomicity}
{
    name=Atomicity,
    text=atomicity,
    description={means that an action is either fully executed or not at all. Atomic operations make sure the application is not left in an invalid state \cite[10]{bernstein_principles_2009}}
}

\newglossaryentry{cap}
{
    name={CAP Theorem},
    description={The CAP theorem by Eric Brewer states that a distributed data store can only display at most two of the following three guarantees at the same time: consistency, availability and partition tolerance \cite{gilbert_brewers_2002}}
}

\newglossaryentry{contract-test}
{
    name={Contract Test},
    text={contract test},
    plural={contract tests},
    description={A contract test verifies that services implement a shared interface by testing their interactions against an explicitly defined contract}
}

\newglossaryentry{groovy}
{
    name=Groovy,
    description={A dynamic JVM language that extends Java with concise syntax and powerful features such as closures, making it well suited for scripting, DSLs, and test code \cite{groovy-homepage}}
}

\newglossaryentry{gpath}
{
    name={GPath Expression},
    text={GPath expression},
    plural={GPath expressions},
    description={A Groovy-based path language for navigating and querying nested object graphs (such as JSON or XML) using concise, expressive selectors and closures  \cite{groovy-gpath}}
}

\newglossaryentry{restassured}
{
    name={REST Assured},
    description={A library for testing HTTP servers}
}

\newglossaryentry{dockerfile}
{
    name=Dockerfile,
    description={A text document containing a series of instructions used to assemble a Docker image}
}

\newglossaryentry{docker}
{
    name=Docker,
    description={Open platform for developing, shipping and running containerized applications}
}

\newglossaryentry{testcontainer}
{
    name=Testcontainer,
    description={Testcontainers are a way to declare infrastructure dependencies as code using Docker \cite{testcontainers-homepage}}
}

\newglossaryentry{percentile}
{
    name=Percentile,
    text=percentile,
    description={A statistical measure indicating the value below which a given percentage of observations in a group of data falls. For example, the $n$-th percentile is the threshold where $n$ percent of requests are faster than that specific value}
}

\newglossaryentry{median}
{
    name={Median (P50)},
    text=median,
    description={The middle value in a sorted list of response times, representing the "typical" delay experienced by users. It indicates that exactly 50\% of requests are served faster than this threshold; the other 50\% are slower}
}

\newglossaryentry{tail-latency}
{
    name={Tail Latency},
    text={tail latency},
    plural={tail latencies},
    description={The response times observed at high percentiles (such as P95, P99, or P99.9), representing the slowest requests in a distribution. These "outliers" are critical to monitor because they often affect the most data-intensive operations or represent the worst-case user experience}
}

\newglossaryentry{test-configuration}
{
    name={Test Configuration},
    text={test configuration},
    description={A test configuration is the combination of a test script and the target RPS.}
}

\newglossaryentry{layered-architecture}
{
    name={Layered Architecture},
    description={divides applications into \emph{horizontal layers}, with each layer performing a specific role. Typical layers include Presentation, Business, Persistence}
}

\newglossaryentry{tuple}
{
    name=Tuple,
    description={An ordered, immutable sequence of elements used to store a collection of data.}
}

\newglossaryentry{schema-evolution}
{
    name={Schema Evolution},
    text={schema evolution},
    description={The process of managing how data structures, such as events or database tables, change over time}
}

\newacronym{www}{WWW}{World Wide Web}

\newacronym{hateoas}{HATEOAS}{Hypermedia as the engine of application state}

\newacronym{html}{HTML}{HyperText Markup Language}

\newacronym{json}{JSON}{JavaScript Object Notation}

\newacronym{xml}{XML}{Extensible Markup Language}

\newacronym{dao}{DAO}{Data Access Object}

\newacronym{ddd}{DDD}{Domain Driven Design}

\newacronym[plural=URIs]{uri}{URI}{Uniform Resource Identifier}

\newacronym{crud}{CRUD}{Create Read Update Delete}

\newacronym{dto}{DTO}{Data Transfer Object}

\newacronym{acid}{ACID}{Atomicity, Consistency, Isolation, Durability}

\newacronym{cqrs}{CQRS}{Command Query Responsibility Segregation}

\newacronym{cqs}{CQS}{Command And Query Separation}

\newacronym{base}{BASE}{Basically Available, Soft State, Eventual Consistency}

\newacronym{es}{ES}{Event Sourcing}

\newacronym{dsl}{DSL}{Data Specific Language}

\newacronym{jpa}{JPA}{Jakarta Persistence API}

\newacronym{orm}{ORM}{Object-relational Mapper}

\newacronym{jpql}{JPQL}{Java Persistence Query Language}

\newacronym{pojo}{POJO}{Plain Old Java Object}

\newacronym{jmx}{JMX}{Java Management Extensions}

\newacronym{VU}{VU}{Virtual User}

\newacronym{rps}{RPS}{Requests Per Second}

\newacronym[plural=SLOs,firstplural={Service Level Objectives (SLOs)}]{slo}{SLO}{Service Level Objective}

\newacronym[plural=SLAs,firstplural={Service Level Agreements (SLAs)}]{sla}{SLA}{Service Level Agreement}

\newacronym{vm}{VM}{Virtual Machine}

\newacronym{ssh}{SSH}{Secure Shell}
 
\newacronym{scp}{SCP}{Secure Copy}

\newacronym[text={research question}]{rq}{RQ}{Research Question}

\newacronym{io}{I/O}{Input / Output}

\newacronym{mood}{MOOD}{Metrics for Object-Oriented Design}

\newacronym{mhf}{MHF}{Method Hiding Factor}

\newacronym{ahf}{AHF}{Attribute Hiding Factor}

\newacronym{mif}{MIF}{Method Inheritance Factor}

\newacronym{aif}{AIF}{Attribute Inheritance Factor}

\newacronym{pf}{PF}{Polymorphism factor}

\newacronym{cf}{CF}{Coupling Factor}

\newacronym{clf}{CLF}{Clustering Factor}

\newacronym{rf}{RF}{Reuse Factor}

\newacronym{ck}{CK}{Chidamber and Kemerer Metrics}

\newacronym{wmc}{WMC}{Weighted Methods per Class}

\newacronym{dit}{DIT}{Depth of Inheritance Tree}

\newacronym{noc}{NOC}{Number of Children}

\newacronym{cbo}{CBO}{Coupling Between Objects}

\newacronym{rfc}{RFC}{Response for a Class}

\newacronym{lcom}{LCOM}{Lack of Cohesion in Methods}

\newacronym{ips}{IPS}{Iterations per Second}

\newacronym{l}{L}{Load Test}

\newacronym[
    description={The "middle" of a dataset, representing the 50\% of data between the 25th and the 75th percentile.}
]{iqr}{IQR}{Interquartile Range}

\begin{document}

\title{Performance, flexibility and traceability: Evaluating the impact of Event Sourcing and CQRS compared to traditional systems with an audit log.}
\author{Lukas Karsch}

\begin{titlepage}
    \centering

    \includegraphics[width=0.3\textwidth]{images/HdM_Logo.svg.png}
    \vspace{1cm}

    %LTeX: language=de-DE
    {\large Bachelorarbeit im Studiengang Medieninformatik}
    % {\large Bachelor's Thesis in Computer Science and Media}

    \vspace{1.5cm}

    %LTeX: language=en-US
    % Title
    {\LARGE\bfseries Performance, flexibility and traceability: Evaluating the impact of Event Sourcing and CQRS compared to traditional systems with an audit log.}
    %LTeX: language=de-DE

    \vspace{0.5cm}
    \rule{\linewidth}{0.5pt}
    \vspace{0.5cm}

    {\large\bfseries Vorgelegt von Lukas Karsch}

    {\small mit der Matrikelnummer 45259}

    \vspace{0.3cm}

    %LTeX: language=de-DE
    {\bfseries an der Hochschule der Medien Stuttgart am 02.03.2026}

    % \vspace{0.2cm}

    % to obtain the degree of Bachelor of Science
    zur Erlangung des akademischen Grades eines Bachelor of Science

    \vfill

    \begin{flushleft}
        \begin{tabular}{ll}
            \textbf{Erstprüfer:}  & Prof. Dr. Tobias Jordine \\[0.3cm]
            \textbf{Zweitprüfer:} & Felix Messner            \\[0.3cm]
        \end{tabular}
    \end{flushleft}
    %LTeX: language=en-US

\end{titlepage}

\newpage
\pagenumbering{roman}
%LTeX: language=de-DE
\section*{Ehrenwörtliche Erklärung}
Hiermit versichere ich, Lukas Karsch, ehrenwörtlich, dass ich die vorliegende Bachelorarbeit mit dem Titel: "Performance, flexibility and traceability: Evaluating the impact of Event Sourcing and CQRS compared to traditional systems with an audit log" selbstständig und ohne fremde Hilfe verfasst und keine anderen als die angegebenen Hilfsmittel benutzt habe. Die Stellen der Arbeit, die dem Wortlaut oder dem Sinn nach anderen Werken entnommen wurden, sind in jedem Fall unter Angabe der Quelle kenntlich gemacht. Ebenso sind alle Stellen, die mit Hilfe eines KI-basierten Schreibwerkzeugs erstellt oder überarbeitet wurden, kenntlich gemacht. Die im Anhang aufgelisteten KI-Werkzeuge wurden ausschließlich zum Lektorat verwendet. Anschließend wurde sichergestellt, dass der Inhalt mit den intendierten Aussagen noch übereinstimmt. Die Arbeit ist noch nicht veröffentlicht oder in anderer Form als Prüfungsleistung vorgelegt worden. Ich habe die Bedeutung der ehrenwörtlichen Versicherung und die prüfungsrechtlichen Folgen (§ 24 Abs. 2 Bachelor-SPO) einer unrichtigen oder unvollständigen ehrenwörtlichen Versicherung zur Kenntnis genommen.

\vspace{1.8cm} % Space for signature

\noindent\rule{7cm}{0.4pt} \\
\noindent \small{Lukas Karsch, 02.03.2026}

%LTeX: language=en-US

\newpage
\include{chapters/ch0_abstract}

\newpage
\tableofcontents

\newpage
\listoffigures
\listoftables
\lstlistoflistings

\newpage
\printglossaries

\newpage
\pagenumbering{arabic}

\include{chapters/ch1_introduction}

\include{chapters/ch2_basics}

\include{chapters/ch3_related_work}

\include{chapters/ch4_methodology}

\include{chapters/ch5_requirement_analysis}

\include{chapters/ch6_implementation}

\include{chapters/ch7_results}

\include{chapters/ch8_discussion}

\newpage
\printbibliography

\appendix

\chapter{Source Code}

The full source code for this thesis, including both applications, performance tests and markdown notes, is available at the following locations:

\begin{itemize}
    \item \url{https://gitlab.mi.hdm-stuttgart.de/lk224/thesis}
    \item \url{https://github.com/lukas-karsch/thesis}
\end{itemize}

The repository contains \texttt{README} files with instructions on how to launch the applications, execute load tests and how to reproduce the \acrshort{vm} environments.

\chapter{Load Testing Results}
\label{appendix:results}

This chapter of the appendix presents tables generated from the results during load testing. The \emph{speedup} represents the factor by which the ES-CQRS application differed from the CRUD application. The statistical significance of the performance differences was evaluated using the \emph{Mann-Whitney U} test. If its result is significant ($p \le 0.05$), that means that the difference in values are unlikely to be due to noise or randomness.

The results are reported using the probability thresholds defined in \autoref{table:significance}, where a lower p-value indicates a higher level of statistical significance.

\begin{table}[htp!]
    \small
    \centering
    \begin{tabularx}{0.7\linewidth}{cll}
        \textbf{Significance} & \textbf{$p$-value} & \textbf{Interpretation} \\
        \midrule
        ***                   & $p \le 0.001$      & Highly significant      \\
        **                    & $p \le 0.01$       & Very significant        \\
        *                     & $p \le 0.05$       & Significant             \\
        n.s.                  & $p > 0.05$         & Not significant         \\
        \bottomrule
    \end{tabularx}
    \caption{Significance thresholds}
    \label{table:significance}
\end{table}

\newpage
\section{L1: Create Course Simple}
\label{results:l1}

\input{tables/run-create-course-simple_client.tex}
\input{tables/run-create-course-simple_server.tex}
\input{tables/run-create-course-simple_CPU_Usage.tex}
\input{tables/run-create-course-simple_Threadpool_Usage.tex}
\input{tables/run-create-course-simple_Database_Connections.tex}
\input{tables/run-create-course-simple_datastore_size.tex}

\newpage
\section{L2: Create Course Prerequisites}
\label{results:l2}

\input{tables/run-create-course-prerequisites_client.tex}
\input{tables/run-create-course-prerequisites_server.tex}
\input{tables/run-create-course-prerequisites_cpu_usage.tex}
\input{tables/run-create-course-prerequisites_threadpool_usage.tex}
\input{tables/run-create-course-prerequisites_Database_Connections.tex}
\input{tables/run-create-course-prerequisites_datastore_size.tex}

\newpage
\section{L3: Enroll to Lecture}
\label{results:l3}

\input{tables/run-enroll-to-lecture_client.tex}
\input{tables/run-enroll-to-lecture_server.tex}
\input{tables/run-enroll-to-lecture_CPU_Usage.tex}
\input{tables/run-enroll-to-lecture_threadpool_usage.tex}
\input{tables/run-enroll-to-lecture_Database_Connections.tex}
\input{tables/run-enroll-to-lecture_datastore_size.tex}

\newpage
\section{L4: Read Lectures for Student}
\label{results:l4}

\input{tables/run-read-lectures_client.tex}
\input{tables/run-read-lectures_server.tex}
\input{tables/run-read-lectures_CPU_Usage.tex}
\input{tables/run-read-lectures_Threadpool_Usage.tex}
\input{tables/run-read-lectures_Database_Connections.tex}

\newpage
\section{L5: Read All Lectures}
\label{results:l5}

\input{tables/run-read-all-lectures_client.tex}
\input{tables/run-read-all-lectures_server.tex}
\input{tables/run-read-all-lectures_CPU_Usage.tex}
\input{tables/run-read-all-lectures_Threadpool_Usage.tex}
\input{tables/run-read-all-lectures_Database_Connections.tex}

\newpage
\section{L6: Get Credits}
\label{results:l6}

\input{tables/run-get-credits_client.tex}
\input{tables/run-get-credits_server.tex}
\input{tables/run-get-credits_CPU_Usage.tex}
\input{tables/run-get-credits_Threadpool_Usage.tex}
\input{tables/run-get-credits_Database_Connections.tex}

\newpage
\section{L7: Time to Consistency}
\label{results:l7}

This load test consists of 2 requests per iteration. Therefore, the client-side latencies for both requests are listed separately. In a third table, the dropped iterations are listed.

\input{tables/run-create-lecture_POST_client.tex}
\input{tables/run-create-lecture_GET_client.tex}
\input{tables/run-create-lecture_dropped_iterations_statistical_test.tex}

\input{tables/run-create-lecture_CPU_Usage.tex}
\input{tables/run-create-lecture_Threadpool_Usage.tex}
\input{tables/run-create-lecture_Database_Connections.tex}
\input{tables/run-create-lecture_datastore_size.tex}
\input{tables/run-create-lecture_client_read_visible_rate_statistical_test.tex}

\newpage
\section{L8: Reconstruct Grade History}
\label{results:l8}

\input{tables/run-grade-history_client.tex}
\input{tables/run-grade-history_server.tex}
\input{tables/run-grade-history_CPU_Usage.tex}
\input{tables/run-grade-history_Threadpool_Usage.tex}
\input{tables/run-grade-history_Database_Connections.tex}

\chapter{Static Analysis Results}
\label{appendix:static-analysis-results}

This chapter lists tables containing the full results of static analysis metrics. To make the tables more readable, some package names are abbreviated according to \autoref{tab:package-name-abbreviations}.

\begin{table}[H]
    \centering
    \small
    \begin{tabular}{ll}
        \toprule
        \textbf{Package Name} & \textbf{Abbreviation} \\
        \midrule
        karsch.lukas          & k.l                   \\
        features              & f                     \\
        lectures              & le                    \\
        enrollment            & e                     \\
        command               & c                     \\
        \bottomrule
    \end{tabular}
    \caption[Package name abbreviations]{Package name abbreviations used when presenting results.}
    \label{tab:package-name-abbreviations}
\end{table}

\section{Coupling Metrics}
\label{appendix:coupling-results}

\input{tables/crud-coupling-per-package.tex}
\input{tables/es-cqrs-coupling-per-package.tex}

\newpage
\section{Instability and Abstractness Metrics}
\label{appendix:instability-abstractness}

\input{tables/instability.tex}
\input{tables/abstractness.tex}
\input{tables/distance.tex}
\input{tables/crud-distance-main-sequence-per-package.tex}
\input{tables/es-cqrs-distance-main-sequence-per-package.tex}

\newpage
\section{Dependency Metrics}
\label{appendix:dependency}

\input{tables/dependency-crud.tex}
\input{tables/dependency-es-cqrs.tex}

\newpage
\section{MOOD}
\label{appendix:mood-results}

\input{tables/mood.tex}

\newpage
\section{Chidamber Kemerer Metrics}
\label{appendix:ck-results}

\input{tables/ck-crud.tex}
\input{tables/ck-es-cqrs.tex}

%LTeX: language=de-DE
\chapter{Nutzung von KI-Tools}

\begin{table}[htp!]
    \small
    \centering
    \begin{tabularx}{\linewidth}{llX}
        \toprule
        \textbf{Kapitel / Codemodul} & \textbf{Tool(s)} & \textbf{Beschreibung und Begründung Einsatzzweck}                                                     \\ \midrule
        Alle Kapitel                 & Gemini           & LaTeX Syntax-Unterstützung bei Tabellen, figures, listings                                            \\
        \addlinespace
        Alle Kapitel                 & DeepL Write      & Grammatikalische und stilistische Überarbeitung von Textsegmenten                                     \\
        \addlinespace
        Alle Kapitel                 & DeepL Translate  & Übersetzung von Wörtern und Formulierungen                                                            \\
        \addlinespace
        Kapitel 7 (Results)          & Gemini           & Hilfe bei der Visualisierung \& statistischen Auswertung der Ergebnisse (matplotlib, pandas, seaborn) \\
        \bottomrule
    \end{tabularx}
    \caption{AI tools used throughout the thesis}
    \label{table:ki-tools}
\end{table}

\end{document}
